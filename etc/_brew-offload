#compdef brew-offload

_brew-offload() {
    local context state line
    typeset -A opt_args

    _arguments -C \
        '(-h --help)'{-h,--help}'[display help information]' \
        '1: :->subcommand' \
        '2: :->arg1' \
        '3: :->arg2'
    
    case $state in
        subcommand)
            local -a subcmds
            subcmds=(
                'add:adding'
                'remove:removing'
                'config:config'
            )
            _describe -t commands 'subcommands' subcmds
            ;;
        arg1)
            case $line[1] in
                add)
                    local -a formulae
                    formulae=()
                    compadd -a formulae
                    ;;
                remove)
                    local -a formulae
                    formulae=()
                    compadd -a formulae
                    ;;
                config)
                    local -a keys
                    keys=(
                        'offload_cellar:the path to the offload cellar'
                        # add other keys
                    )
                    _describe -t keys 'keys' keys
                    ;;
            esac
            ;;
        arg2)
            case $line[1] in
                config)
                    case $line[2] in
                        offload_cellar)
                            _files -fg '*.json'
                            ;;
                    esac
                    ;;
            esac
    esac
}
