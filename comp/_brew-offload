#compdef brew-offload

_brew-offload() {
    local context state line
    typeset -A opt_args

    _arguments -C \
        '(-h --help)'{-h,--help}'[display help information]' \
        '1: :->subcommand' \
        '2: :->arg1' \
        '3: :->arg2'
    
    case $state in
        subcommand)
            local -a subcmds
            subcmds=(
                'add:adding'
                'remove:removing'
                'config:config'
            )
            _describe -t commands 'subcommands' subcmds
            ;;
        arg1)
            case $line[1] in
                add)
                    local -a formulae
                    formulae=()
                    compadd -a formulae
                    ;;
                remove)
                    local -a formulae
                    formulae=()
                    compadd -a formulae
                    ;;
                config)
                    local -a keys
                    keys=(
                        'offload_cellar:the path to the offload cellar'
                        # add other keys
                    )
                    _describe -t keys 'keys' keys
                    ;;
            esac
            ;;
        arg2)
            case $line[1] in
                config)
                    case $line[2] in
                        offload_cellar)
                            _files -fg '*.json'
                            ;;
                    esac
                    ;;
            esac
    esac
}

# _brew-offload "$@"

_mycmd() {
    local context state line
    typeset -A opt_args

    _arguments -C \
        '(-h --help)'{-h,--help}'[ヘルプを表示]' \
        '--version[バージョンを表示]' \
        '--config[設定ファイルを指定]:config file:_files' \
        '--mode[動作モードを選択]:mode:(fast slow normal)' \
        '1: :->command' \
        '*: :->args'

    case $state in
        command)
            local -a subcmds
            subcmds=(
                'install:パッケージをインストール'
                'search:パッケージを検索'
            )
            _describe -t commands 'subcommands' subcmds
            ;;
        args)
            case $line[1] in
                install)
                    _arguments '*:package name:_path_files'
                    ;;
                search)
                    _arguments '--deep[深層検索]'
                    ;;
            esac
            ;;
    esac
}

: _mycmd "$@"
